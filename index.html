<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Golden Moms ‚Äî Panel</title>
  <link rel="icon" href="Logo.webp"/>

  <!-- üé® Estilos -->
  <style>
    :root{--blue:#0f3a78;--lime:#9be22d;--ink:#0f172a;--mut:#64748b;--b:#e2e8f0;--bg:#f7f8fa;--ok:#d9f99d;--mid:#fef9c3;--no:#fee2e2}
    *{box-sizing:border-box}html,body{margin:0;height:100%;background:var(--bg);color:var(--ink);font-family:Inter,system-ui,Segoe UI,Roboto,Arial}
    a{color:inherit} .small{color:var(--mut);font-size:12px}
    .btn{border:1px solid var(--b);border-radius:10px;padding:8px 12px;background:#fff;cursor:pointer}
    .btn.p{background:var(--lime);border-color:#a3e635;font-weight:800}
    .btn.s{background:#f8fafc}
    .badge{font-size:11px;border:1px solid var(--b);border-radius:999px;padding:2px 8px;background:#f8fafc}
    .top{position:sticky;top:0;z-index:30;background:#fff;border-bottom:1px solid var(--b);display:flex;align-items:center;justify-content:space-between;padding:10px 14px}
    .brand{display:flex;gap:10px;align-items:center}.brand img{width:32px;height:32px;border-radius:50%;border:2px solid var(--blue)}
    .nav{display:flex;gap:8px;flex-wrap:wrap}.nav .tab{border:1px solid var(--b);border-radius:999px;padding:8px 12px;background:#fff;cursor:pointer}
    .nav .tab.active{background:var(--blue);color:#fff}
    .container{max-width:1200px;margin:14px auto;padding:0 12px}
    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:12px}
    .card{background:#fff;border:1px solid var(--b);border-radius:12px;box-shadow:0 8px 20px #0000000a;padding:12px}
    .kpi h3{margin:0;color:var(--mut);font-size:14px}.kpi .n{font-size:22px;font-weight:800}
    .roster{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
    .pcard{border:1px solid var(--b);border-radius:12px;padding:10px;background:#fff}
    .phead{display:flex;gap:10px;align-items:center}
    .pimg{width:56px;height:56px;border-radius:50%;background:#eee;border:2px solid var(--blue)}
    @media (max-width: 900px){
      .grid{grid-template-columns:1fr}
      .roster{grid-template-columns:repeat(2,1fr)}
    }
  </style>

  <!-- üöÄ SDK Supabase -->
  <script defer src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body>

  <!-- üü¶ Barra Superior -->
  <div class="top">
    <div class="brand">
      <img src="Logo.webp" alt="GM"/>
      <div><strong>Golden</strong> <span style="color:var(--lime);font-weight:800">Moms</span></div>
    </div>
    <div class="nav">
      <button class="tab active" data-view="dash">Dashboard</button>
      <button class="tab" data-view="events">Eventos</button>
      <button class="tab" data-view="roster">Plantel</button>
      <button class="tab" data-view="track">Seguimiento</button>
      <button class="tab" data-view="conf">Configuraci√≥n</button>
    </div>
  </div>

  <!-- üü© Contenedor din√°mico -->
  <div class="container"></div>

  <!-- ‚ö° Script √öNICO (antes ten√≠as dos bloques completos) -->
  <script>
    /*** === Configuraci√≥n Supabase === ***/
    const SUPA = {
      url: "https://xglojvvbgaivwbpdxvne.supabase.co",
      key: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhnbG9qdnZiZ2FpdndicGR4dm5lIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUxMjEzMjQsImV4cCI6MjA3MDY5NzMyNH0.vQOBuvphgm0iue-lybJoBVhyai7RtRp8Tfn-hGIKKgw"
    };
    const supa = window.supabase.createClient(SUPA.url, SUPA.key);

    /*** === Estado Global === ***/
    let state = { team:"Golden Moms", roster:[], events:[] };

    /*** === Cargar estado desde tabla === ***/
    async function loadState() {
      const { data, error } = await supa.from("gm_state").select("data").eq("id",1).single();
      if (error) {
        console.error("‚ùå Error al cargar:", error);
      } else if (data && data.data) {
        state = data.data;
      }
      renderAll();
    }

    /*** === Guardar estado === ***/
    async function saveState() {
      const { error } = await supa.from("gm_state").upsert({
        id: 1,
        data: state,
        updated_at: new Date().toISOString()
      });
      if (error) console.error("‚ùå Error al guardar:", error);
    }

    /*** === Renderizadores === ***/
    function renderDashboard() {
      document.querySelector(".container").innerHTML = `
        <div class="card kpi"><h3>Equipo</h3><div class="n">${state.team}</div></div>
        <div class="card kpi"><h3>Jugadoras</h3><div class="n">${state.roster.length}</div></div>
        <div class="card kpi"><h3>Eventos</h3><div class="n">${state.events.length}</div></div>
      `;
    }

    function renderRoster() {
      if (!state.roster.length) {
        document.querySelector(".container").innerHTML = "<p>No hay jugadoras registradas.</p>";
        return;
      }
      document.querySelector(".container").innerHTML = `
        <div class="roster">
          ${state.roster.map(p => `
            <div class="pcard">
              <div class="phead"><div class="pimg"></div><strong>${p.nombre}</strong></div>
            </div>
          `).join("")}
        </div>
      `;
    }

    function renderEvents() {
      if (!state.events.length) {
        document.querySelector(".container").innerHTML = "<p>No hay eventos programados.</p>";
        return;
      }
      document.querySelector(".container").innerHTML = state.events.map(ev =>
        `<div class="card"><strong>${ev.title}</strong><br><small>${ev.datetime}</small></div>`
      ).join("");
    }

    function renderAll() {
      const view = document.querySelector(".nav .tab.active").dataset.view;
      if (view === "dash") renderDashboard();
      if (view === "roster") renderRoster();
      if (view === "events") renderEvents();
      if (view === "track") document.querySelector(".container").innerHTML = "<p>Seguimiento en construcci√≥n</p>";
      if (view === "conf") document.querySelector(".container").innerHTML = "<p>Configuraci√≥n en construcci√≥n</p>";
    }

    /*** === Init === ***/
    document.addEventListener("DOMContentLoaded", () => {
      loadState();
      document.querySelectorAll(".nav .tab").forEach(btn => {
        btn.addEventListener("click", () => {
          document.querySelectorAll(".nav .tab").forEach(t => t.classList.remove("active"));
          btn.classList.add("active");
          renderAll();
        });
      });
    });
  </script>
</body>
</html>
