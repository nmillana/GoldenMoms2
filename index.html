<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Golden Moms ‚Äî Panel</title>
<link rel="icon" href="Logo.webp"/>
<script src="https://unpkg.com/@supabase/supabase-js@2"></script>
<style>
/* (mant√©n aqu√≠ todo tu CSS tal como lo tienes - omitido en este snippet para brevedad) */
:root{ --blue:#0f3a78; --lime:#9be22d; --ink:#0f172a; --mut:#64748b; --b:#e2e8f0; --bg:#f7f8fa; --lime-strong:#7fd410; --blue-strong:#0a2a58; --title-size:12px; --content-size:10px; --sub-size:8px; --kpi-number-size:22px; --day-bold-size: 16px; --day-bold-size-mobile: 14px; --week-sep-height: 8px; --week-sep-color: #000; --today-border-color: #ff3b3b; --month-grid-gap: 18px; --month-list-gap: 12px; }
/* ...resto CSS intacto... */
</style>
</head>
<body>

<!-- Top -->
<div class="top">
  <div class="brand">
    <img src="Logo.webp" alt="GM"/>
    <div><strong>Golden</strong> <span style="color:var(--lime);font-weight:800">Moms</span></div>
  </div>
  <div style="display:flex;align-items:center;gap:12px">
    <div class="nav" role="tablist" aria-label="Navegaci√≥n">
      <button class="tab active" data-view="dash">Dashboard</button>
      <button class="tab" data-view="events">Eventos</button>
      <button class="tab" data-view="roster">Plantel</button>
      <button class="tab" data-view="matches">Partidos</button>
    </div>
  </div>
</div>

<!-- --- FIX R√ÅPIDO: manejador de pesta√±as independiente (fallback) --- -->
<script>
/*
  Quick tab fallback: esto permite cambiar de pesta√±a aun si
  el resto del script (p.ej. initSupabase) est√° tardando o fall√≥.
  Tambi√©n intenta invocar las funciones de render si ya existen.
*/
(function(){
  function quickShowView(v){
    ['dash','events','roster','matches'].forEach(id=>{
      const el = document.getElementById('v-'+id);
      if(el) el.style.display = 'none';
    });
    const target = document.getElementById('v-'+v) || document.getElementById('v-dash');
    if(target) target.style.display = 'block';

    // active class visual
    document.querySelectorAll('.nav .tab').forEach(b=>b.classList.remove('active'));
    const btn = document.querySelector('.nav .tab[data-view="'+v+'"]');
    if(btn) btn.classList.add('active');

    // persist preference (no falla si storage bloqueado)
    try{ localStorage.setItem('gm_view', v); }catch(e){}

    // Si las funciones de render est√°n disponibles, ll√°malas
    try{
      if(v === 'dash' && typeof renderDash === 'function') renderDash();
      if(v === 'events' && typeof renderMonth === 'function') renderMonth();
      if(v === 'matches' && typeof renderMatches === 'function') renderMatches();
      if(v === 'roster' && typeof renderDash === 'function') renderDash(); // roster se actualiza desde renderDash
    }catch(err){
      // silently ignore: es solo un intento de integraci√≥n
      console.warn('quickShowView render call error', err);
    }
  }

  // attach handlers immediately
  document.querySelectorAll('.nav .tab').forEach(btn=>{
    btn.addEventListener('click', function(e){
      e.preventDefault();
      const view = this.dataset.view || 'dash';
      quickShowView(view);
    });
  });

  // show persisted view quickly on load (sin esperar al resto)
  try{
    const persisted = (function(){ try{ return localStorage.getItem('gm_view'); }catch(e){ return null; } })() || 'dash';
    quickShowView(persisted);
  }catch(e){}
})();
</script>
<!-- --- FIN FIX R√ÅPIDO --- -->

<div class="container">
  <!-- (mant√©n aqu√≠ el resto de tu HTML tal cual: DASHBOARD, EVENTOS, PLANTEL, PARTIDOS, modales, etc.) -->

  <!-- DASHBOARD -->
  <section id="v-dash">
    <div class="grid" style="align-items:stretch">
      <div class="card kpi" style="grid-column:span 6;display:flex;flex-direction:column;justify-content:space-between">
        <div>
          <h4>Plantel</h4>
          <div class="n" id="kRoster">0</div>
          <div style="font-size:var(--sub-size);color:var(--mut)">Integrantes registrados</div>
        </div>
      </div>

      <div class="card kpi" style="grid-column:span 6;display:flex;flex-direction:column;justify-content:space-between">
        <div>
          <h4>Partidos jugados</h4>
          <div class="n" id="kGames">0</div>
          <div id="lastMatchSummary" style="font-size:var(--content-size);color:var(--mut)"></div>
        </div>
        <div style="margin-top:8px;display:flex;justify-content:flex-end">
          <button class="btn s" onclick="showView && showView('matches')">Ir a partidos</button>
        </div>
      </div>
    </div>

    <!-- (resto del dashboard...) -->
  </section>

  <!-- EVENTOS -->
  <section id="v-events" style="display:none">
    <!-- (tu contenido de eventos) -->
  </section>

  <!-- PLANTEL -->
  <section id="v-roster" style="display:none">
    <!-- (tu contenido de roster) -->
  </section>

  <!-- PARTIDOS -->
  <section id="v-matches" style="display:none">
    <!-- (tu contenido de matches) -->
  </section>
</div>

<footer style="text-align:center;padding:16px;color:var(--mut);font-size:var(--content-size)">Golden Moms ¬∑ hecho con üíö lima & azul</footer>

<!-- (modales y resto de tu HTML/JS exactamente igual; aseg√∫rate de mantener las IDs) -->

<!-- Aqu√≠ va el resto completo de tu <script> original que inicializa Supabase,
     maneja los modales, renderMonth(), renderDash(), renderMatches(), etc. -->
<script>
/* ---------- Supabase config & init ---------- */
const SUPA = {
  url: "https://xglojvvbgaivwbpdxvne.supabase.co",
  key: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhnbG9qdnZiZ2FpdndicGR4dm5lIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUxMjEzMjQsImV4cCI6MjA3MDY5NzMyNH0.vQOBuvphgm0iue-lybJoBVhyai7RtRp8Tfn-hGIKKgw"
};
let supa = null;
async function initSupabase(timeoutMs = 8000){
  try{
    if(typeof createClient === 'function'){ supa = createClient(SUPA.url, SUPA.key); return supa; }
    if(window.supabase && typeof window.supabase.createClient === 'function'){ supa = window.supabase.createClient(SUPA.url, SUPA.key); return supa; }
    await new Promise((resolve,reject)=>{
      const s = document.createElement('script');
      s.src = 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/supabase.min.js';
      s.async = true;
      let done=false;
      const to=setTimeout(()=>{ if(!done){ done=true; reject(new Error('timeout cargando supabase')); }}, timeoutMs);
      s.onload=()=>{ if(done) return; done=true; clearTimeout(to); resolve(); };
      s.onerror=()=>{ if(done) return; done=true; clearTimeout(to); reject(new Error('error cargando supabase')); };
      document.head.appendChild(s);
    });
    if(typeof createClient === 'function'){ supa = createClient(SUPA.url, SUPA.key); return supa; }
    if(window.supabase && typeof window.supabase.createClient === 'function'){ supa = window.supabase.createClient(SUPA.url, SUPA.key); return supa; }
    throw new Error('SDK cargado pero no se encontr√≥ createClient');
  }catch(err){ console.error('initSupabase error:', err); supa = null; return null; }
}

/* ...resto de tu script tal cual lo ten√≠as (helpers, modales, renderMonth, renderDash, renderMatches, player modal, etc.) ... */

/* Nota: no modifiqu√© esta secci√≥n para conservar tu l√≥gica; el "quickShowView" anterior
   garantiza que las pesta√±as respondan aunque algo en esta secci√≥n falle. */
</script>

</body>
</html>
